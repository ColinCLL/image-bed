# CI/CD 自动化功能说明

## 🎯 功能概述

这个项目已经配置了完整的CI/CD（持续集成/持续部署）自动化流程，让您可以实现真正的"上传即部署"。

## 🤖 自动化流程

### 触发条件
当您向GitHub仓库推送包含以下格式的图片文件时，自动化流程会自动启动：
- `.jpg`, `.jpeg`
- `.png`
- `.gif`
- `.webp`
- `.bmp`
- `.tiff`, `.tif`

### 执行步骤
1. **自动检出代码** - 获取最新的项目文件
2. **设置Python环境** - 准备运行环境
3. **安装依赖** - 安装Pillow等必要库
4. **扫描图片文件** - 运行图片扫描脚本
5. **检查更新** - 判断是否有新的图片数据
6. **自动提交** - 如果有更新，自动提交到GitHub
7. **显示结果** - 输出扫描结果和统计信息

## 📁 相关文件

### 工作流配置
- `.github/workflows/auto-scan-images.yml` - GitHub Actions工作流配置

### 依赖文件
- `requirements.txt` - Python依赖包列表
- `image_scanner.py` - 基础图片扫描脚本
- `image_scanner_advanced.py` - 高级图片扫描脚本（支持缩略图）

## 🚀 使用方法

### 完全自动化（推荐）

1. **上传图片**到项目目录
2. **推送到GitHub**：
   ```bash
   git add .
   git commit -m "添加新图片"
   git push
   ```
3. **等待自动部署**（1-5分钟）
4. **分享链接**给模特

### 手动触发

如果您想手动触发扫描：

1. 进入GitHub仓库页面
2. 点击 "Actions" 标签
3. 选择 "自动扫描图片并更新网站" 工作流
4. 点击 "Run workflow" 按钮
5. 选择分支并点击 "Run workflow"

## 📊 监控和日志

### 查看执行状态
1. 进入GitHub仓库页面
2. 点击 "Actions" 标签
3. 查看工作流执行历史
4. 点击具体的执行记录查看详细日志

### 日志内容
- 扫描的图片数量和文件名
- 文件大小和修改时间
- 错误信息（如果有）
- 部署状态和链接

## ⚙️ 配置选项

### 修改触发条件
编辑 `.github/workflows/auto-scan-images.yml` 文件中的 `paths` 部分：

```yaml
paths:
  - '*.jpg'
  - '*.jpeg'
  - '*.png'
  # 添加更多格式
```

### 修改扫描脚本
可以替换为高级扫描脚本：

```yaml
- name: 扫描图片文件
  run: |
    echo "开始扫描图片文件..."
    python image_scanner_advanced.py
```

### 添加通知功能
可以在工作流中添加邮件或Slack通知：

```yaml
- name: 发送通知
  if: steps.check-changes.outputs.has_changes == 'true'
  run: |
    # 发送通知的代码
```

## 🔧 故障排除

### 常见问题

1. **工作流不触发**
   - 检查文件格式是否在触发列表中
   - 确认推送到的是main分支
   - 检查GitHub Actions是否启用

2. **扫描失败**
   - 检查Python脚本语法
   - 确认依赖包已正确安装
   - 查看详细错误日志

3. **自动提交失败**
   - 检查GitHub Token权限
   - 确认仓库设置正确
   - 查看提交历史

### 调试方法

1. **查看工作流日志**
   - 进入Actions页面
   - 点击失败的执行记录
   - 查看具体步骤的日志

2. **本地测试**
   - 在本地运行 `python image_scanner.py`
   - 检查生成的 `images_data.json` 文件
   - 验证图片路径是否正确

## 🎯 最佳实践

### 文件命名
- 使用有意义的文件名
- 避免使用中文和特殊字符
- 保持文件名简洁

### 图片管理
- 定期清理不需要的图片
- 保持图片质量与文件大小的平衡
- 使用统一的命名规范

### 版本控制
- 每次更新都提交到Git
- 使用有意义的提交信息
- 定期备份重要文件

## 📈 性能优化

### 工作流优化
- 使用缓存减少重复下载
- 并行处理多个图片
- 优化依赖安装时间

### 图片优化
- 压缩图片文件大小
- 使用WebP格式
- 生成缩略图

## 🔒 安全考虑

### 权限管理
- 使用最小权限原则
- 定期更新GitHub Token
- 监控工作流执行

### 数据保护
- 不要在文件名中包含敏感信息
- 考虑使用水印保护图片
- 定期更新图片链接

---

**通过这个CI/CD自动化系统，您只需要上传图片，剩下的所有工作都会自动完成！** 🎉 